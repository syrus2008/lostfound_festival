{% extends "base.html" %}
{% block content %}

  <h2 class="mb-4">Paires potentielles Lost ↔ Found</h2>

  {# Barre de filtrage du seuil #}
  <form class="row g-3 mb-4" method="get" action="{{ url_for('main.list_matches') }}">
    <div class="col-md-2">
      <label class="form-label">Seuil similarité (%)</label>
      <input type="number" name="threshold" class="form-control" min="0" max="100" value="{{ threshold }}">
    </div>
    <div class="col-md-2 align-self-end">
      <button type="submit" class="btn btn-primary">Appliquer</button>
    </div>
  </form>

  {% if pairs %}
    <div class="table-responsive">
      <table class="table table-striped align-middle">
        <thead>
          <tr>
            <th scope="col">Lost ID</th>
            <th scope="col">Titre (Lost)</th>
            <th scope="col">Found ID</th>
            <th scope="col">Titre (Found)</th>
            <th scope="col">Catégorie</th>
            <th scope="col">Score</th>
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody>
          {% for lost, found, score in pairs %}
            <tr>
              <td>{{ lost.id }}</td>
              <td>{{ lost.title }}</td>
              <td>{{ found.id }}</td>
              <td>{{ found.title }}</td>
              <td>{{ lost.category.name }}</td>
              <td>{{ score }}%</td>
              <td>
                <form method="post" action="{{ url_for('main.confirm_match') }}">
                  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                  <input type="hidden" name="lost_id" value="{{ lost.id }}">
                  <input type="hidden" name="found_id" value="{{ found.id }}">
                  <button type="submit" class="btn btn-sm btn-success">Valider</button>
                  <a href="{{ url_for('main.list_matches') }}" class="btn btn-sm btn-secondary">Ignorer</a>
                </form>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <p class="text-muted">Aucune paire potentielle supérieure au seuil {{ threshold }} %.</p>
  {% endif %}

{% endblock %}
